<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>Registro - Git Course</title>

  <!-- CSS principal do curso -->
  <link rel="stylesheet" href="../assets/css/gitcourse.css">

  <!-- CSS específico da página -->
  <link rel="stylesheet" href="../static/css/pages/register.css">
</head>

<body>

  <main>
    <div class="container register-box">

      <h1 style="text-align:center; margin-bottom:25px;">Criar Conta</h1>

      <div class="card" style="padding:30px;">

        <h2 style="text-align:center; margin-bottom:20px;">Registre-se</h2>

        <form id="registerForm">

          <label for="email">Email</label>
          <input type="email" id="email" required>

          <label for="password">Senha</label>
          <input type="password" id="password" required>

          <button type="submit" class="btn-footer-primary" style="width:100%; margin-top:15px;">
            Registrar
          </button>

        </form>

        <div id="result" style="margin-top:15px;"></div>

        <p style="text-align:center; margin-top:20px;">
          Já tem conta?
          <a href="login.html" class="footer-link">Faça login</a>
        </p>

      </div>

      <div class="footer" style="margin-top:30px;">
        <p>&copy; 2025 Curso de Git</p>

        <div class="footer-badges">

          <a href="https://pages.github.com/" class="github-link">
            <span>Powered by GitHub Pages</span>
            <img src="../static/images/github-mark-white.png"
                 alt="GitHub Logo"
                 class="footer-logo"
                 width="16" height="16">
          </a>

          <a href="https://jigsaw.w3.org/css-validator/check/referer" class="w3c-link">
            <img src="https://jigsaw.w3.org/css-validator/images/vcss"
                 alt="CSS válido!"
                 class="footer-logo"
                 width="45" height="16">
          </a>

        </div>
      </div>

    </div>
  </main>

  <!-- Configuração global de API -->
  <script src="../static/js/config.js"></script>

  <script>
document.getElementById("registerForm").addEventListener("submit", async (e) => {
    e.preventDefault();

    const email = document.getElementById("email").value.trim();
    const password = document.getElementById("password").value.trim();
    const resultEl = document.getElementById("result");

    resultEl.style.color = "#333";
    resultEl.textContent = "Registrando...";

    try {
        const response = await fetch("http://127.0.0.1:8000/auth/register", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({ email, password })
        });

        const data = await response.json();

        if (response.ok) {
            resultEl.style.color = "#388e3c";
            resultEl.textContent = "Registro realizado com sucesso! Redirecionando...";

            setTimeout(() => {
                window.location.href = "auth/login.html";
            }, 1200);

        } else {
            resultEl.style.color = "#d32f2f";

            if (typeof data.detail === "string") {
                resultEl.textContent = "Erro: " + data.detail;
            } else if (Array.isArray(data.detail)) {
                resultEl.textContent = "Erro: " + data.detail[0].msg;
            } else {
                resultEl.textContent = "Erro ao registrar.";
            }
        }

    } catch (err) {
        console.error(err);
        resultEl.style.color = "#d32f2f";
        resultEl.textContent = "Erro ao conectar ao servidor.";
    }
});
</script>


</body>
</html>
